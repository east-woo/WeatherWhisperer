{"ast":null,"code":"/**\n * @module ol/format/IIIFInfo\n */\n\nimport { assert } from '../asserts.js';\n\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\nexport const Versions = {\n  VERSION1: 'version1',\n  VERSION2: 'version2',\n  VERSION3: 'version3'\n};\n\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\nconst IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n  'level0': {\n    supports: [],\n    formats: [],\n    qualities: ['native']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['native']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['native', 'color', 'grey', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByDistortedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default', 'bitonal']\n  }\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level1': {\n    supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n    formats: ['jpg'],\n    qualities: ['default']\n  },\n  'level2': {\n    supports: ['regionByPx', 'regionSquare', 'regionByPct', 'sizeByW', 'sizeByH', 'sizeByPct', 'sizeByConfinedWh', 'sizeByWh'],\n    formats: ['jpg', 'png'],\n    qualities: ['default']\n  }\n};\nIIIF_PROFILE_VALUES['none'] = {\n  'none': {\n    supports: [],\n    formats: [],\n    qualities: []\n  }\n};\nconst COMPLIANCE_VERSION1 = /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nconst COMPLIANCE_VERSION2 = /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nconst COMPLIANCE_VERSION3 = /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\nfunction generateVersion1Options(iiifInfo) {\n  let levelProfile = iiifInfo.getComplianceLevelSupportedFeatures();\n  // Version 1.0 and 1.1 do not require a profile.\n  if (levelProfile === undefined) {\n    levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n  }\n  return {\n    url: iiifInfo.imageInfo['@id'] === undefined ? undefined : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    supports: levelProfile.supports,\n    formats: [...levelProfile.formats, iiifInfo.imageInfo.formats === undefined ? [] : iiifInfo.imageInfo.formats],\n    qualities: [...levelProfile.qualities, iiifInfo.imageInfo.qualities === undefined ? [] : iiifInfo.imageInfo.qualities],\n    resolutions: iiifInfo.imageInfo.scale_factors,\n    tileSize: iiifInfo.imageInfo.tile_width !== undefined ? iiifInfo.imageInfo.tile_height !== undefined ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height] : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width] : iiifInfo.imageInfo.tile_height != undefined ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height] : undefined\n  };\n}\nfunction generateVersion2Options(iiifInfo) {\n  const levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    additionalProfile = Array.isArray(iiifInfo.imageInfo.profile) && iiifInfo.imageInfo.profile.length > 1,\n    profileSupports = additionalProfile && iiifInfo.imageInfo.profile[1].supports ? iiifInfo.imageInfo.profile[1].supports : [],\n    profileFormats = additionalProfile && iiifInfo.imageInfo.profile[1].formats ? iiifInfo.imageInfo.profile[1].formats : [],\n    profileQualities = additionalProfile && iiifInfo.imageInfo.profile[1].qualities ? iiifInfo.imageInfo.profile[1].qualities : [];\n  return {\n    url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height === undefined ? tile.width : tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: [...levelProfile.supports, ...profileSupports],\n    formats: [...levelProfile.formats, ...profileFormats],\n    qualities: [...levelProfile.qualities, ...profileQualities]\n  };\n}\nfunction generateVersion3Options(iiifInfo) {\n  const levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    formats = iiifInfo.imageInfo.extraFormats === undefined ? levelProfile.formats : [...levelProfile.formats, ...iiifInfo.imageInfo.extraFormats],\n    preferredFormat = iiifInfo.imageInfo.preferredFormats !== undefined && Array.isArray(iiifInfo.imageInfo.preferredFormats) && iiifInfo.imageInfo.preferredFormats.length > 0 ? iiifInfo.imageInfo.preferredFormats.filter(function (format) {\n      return ['jpg', 'png', 'gif'].includes(format);\n    }).reduce(function (acc, format) {\n      return acc === undefined && formats.includes(format) ? format : acc;\n    }, undefined) : undefined;\n  return {\n    url: iiifInfo.imageInfo['id'],\n    sizes: iiifInfo.imageInfo.sizes === undefined ? undefined : iiifInfo.imageInfo.sizes.map(function (size) {\n      return [size.width, size.height];\n    }),\n    tileSize: iiifInfo.imageInfo.tiles === undefined ? undefined : [iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.width;\n    })[0], iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.height;\n    })[0]],\n    resolutions: iiifInfo.imageInfo.tiles === undefined ? undefined : iiifInfo.imageInfo.tiles.map(function (tile) {\n      return tile.scaleFactors;\n    })[0],\n    supports: iiifInfo.imageInfo.extraFeatures === undefined ? levelProfile.supports : [...levelProfile.supports, ...iiifInfo.imageInfo.extraFeatures],\n    formats: formats,\n    qualities: iiifInfo.imageInfo.extraQualities === undefined ? levelProfile.qualities : [...levelProfile.qualities, ...iiifInfo.imageInfo.extraQualities],\n    preferredFormat: preferredFormat\n  };\n}\nconst versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\nclass IIIFInfo {\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   */\n  constructor(imageInfo) {\n    this.setImageInfo(imageInfo);\n  }\n\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   * @api\n   */\n  setImageInfo(imageInfo) {\n    if (typeof imageInfo == 'string') {\n      this.imageInfo = JSON.parse(imageInfo);\n    } else {\n      this.imageInfo = imageInfo;\n    }\n  }\n\n  /**\n   * @return {Versions|undefined} Major IIIF version.\n   * @api\n   */\n  getImageApiVersion() {\n    if (this.imageInfo === undefined) {\n      return undefined;\n    }\n    let context = this.imageInfo['@context'] || 'ol-no-context';\n    if (typeof context == 'string') {\n      context = [context];\n    }\n    for (let i = 0; i < context.length; i++) {\n      switch (context[i]) {\n        case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n        case 'http://iiif.io/api/image/1/context.json':\n          return Versions.VERSION1;\n        case 'http://iiif.io/api/image/2/context.json':\n          return Versions.VERSION2;\n        case 'http://iiif.io/api/image/3/context.json':\n          return Versions.VERSION3;\n        case 'ol-no-context':\n          // Image API 1.0 has no '@context'\n          if (this.getComplianceLevelEntryFromProfile(Versions.VERSION1) && this.imageInfo.identifier) {\n            return Versions.VERSION1;\n          }\n          break;\n        default:\n      }\n    }\n    assert(false, 'Cannot determine IIIF Image API version from provided image information JSON');\n  }\n\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string|undefined} Compliance level as it appears in the IIIF image information\n   * response.\n   */\n  getComplianceLevelEntryFromProfile(version) {\n    if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n      return undefined;\n    }\n    if (version === undefined) {\n      version = this.getImageApiVersion();\n    }\n    switch (version) {\n      case Versions.VERSION1:\n        if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION3:\n        if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION2:\n        if (typeof this.imageInfo.profile === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        if (Array.isArray(this.imageInfo.profile) && this.imageInfo.profile.length > 0 && typeof this.imageInfo.profile[0] === 'string' && COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])) {\n          return this.imageInfo.profile[0];\n        }\n        break;\n      default:\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n   */\n  getComplianceLevelFromProfile(version) {\n    const complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n    if (complianceLevel === undefined) {\n      return undefined;\n    }\n    const level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n    return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n  }\n\n  /**\n   * @return {SupportedFeatures|undefined} Image formats, qualities and region / size calculation\n   * methods that are supported by the IIIF service.\n   */\n  getComplianceLevelSupportedFeatures() {\n    if (this.imageInfo === undefined) {\n      return undefined;\n    }\n    const version = this.getImageApiVersion();\n    const level = this.getComplianceLevelFromProfile(version);\n    if (level === undefined) {\n      return IIIF_PROFILE_VALUES['none']['none'];\n    }\n    return IIIF_PROFILE_VALUES[version][level];\n  }\n\n  /**\n   * @param {PreferredOptions} [preferredOptions] Optional options for preferred format and quality.\n   * @return {import(\"../source/IIIF.js\").Options|undefined} IIIF tile source ready constructor options.\n   * @api\n   */\n  getTileSourceOptions(preferredOptions) {\n    const options = preferredOptions || {},\n      version = this.getImageApiVersion();\n    if (version === undefined) {\n      return undefined;\n    }\n    const imageOptions = version === undefined ? undefined : versionFunctions[version](this);\n    if (imageOptions === undefined) {\n      return undefined;\n    }\n    return {\n      url: imageOptions.url,\n      version: version,\n      size: [this.imageInfo.width, this.imageInfo.height],\n      sizes: imageOptions.sizes,\n      format: options.format !== undefined && imageOptions.formats.includes(options.format) ? options.format : imageOptions.preferredFormat !== undefined ? imageOptions.preferredFormat : 'jpg',\n      supports: imageOptions.supports,\n      quality: options.quality && imageOptions.qualities.includes(options.quality) ? options.quality : imageOptions.qualities.includes('native') ? 'native' : 'default',\n      resolutions: Array.isArray(imageOptions.resolutions) ? imageOptions.resolutions.sort(function (a, b) {\n        return b - a;\n      }) : undefined,\n      tileSize: imageOptions.tileSize\n    };\n  }\n}\nexport default IIIFInfo;","map":{"version":3,"names":["assert","Versions","VERSION1","VERSION2","VERSION3","IIIF_PROFILE_VALUES","supports","formats","qualities","COMPLIANCE_VERSION1","COMPLIANCE_VERSION2","COMPLIANCE_VERSION3","generateVersion1Options","iiifInfo","levelProfile","getComplianceLevelSupportedFeatures","undefined","url","imageInfo","replace","resolutions","scale_factors","tileSize","tile_width","tile_height","generateVersion2Options","additionalProfile","Array","isArray","profile","length","profileSupports","profileFormats","profileQualities","sizes","map","size","width","height","tiles","tile","scaleFactors","generateVersion3Options","extraFormats","preferredFormat","preferredFormats","filter","format","includes","reduce","acc","extraFeatures","extraQualities","versionFunctions","IIIFInfo","constructor","setImageInfo","JSON","parse","getImageApiVersion","context","i","getComplianceLevelEntryFromProfile","identifier","version","test","getComplianceLevelFromProfile","complianceLevel","level","match","getTileSourceOptions","preferredOptions","options","imageOptions","quality","sort","a","b"],"sources":["C:/Users/dongwoo/Desktop/WeatherWhisperer/src/main/fronted/node_modules/ol/format/IIIFInfo.js"],"sourcesContent":["/**\n * @module ol/format/IIIFInfo\n */\n\nimport {assert} from '../asserts.js';\n\n/**\n * @typedef {Object} PreferredOptions\n * @property {string} [format] Preferred image format. Will be used if the image information\n * indicates support for that format.\n * @property {string} [quality] IIIF image qualitiy.  Will be used if the image information\n * indicates support for that quality.\n */\n\n/**\n * @typedef {Object} SupportedFeatures\n * @property {Array<string>} [supports] Supported IIIF image size and region\n * calculation features.\n * @property {Array<string>} [formats] Supported image formats.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n */\n\n/**\n * @typedef {Object} TileInfo\n * @property {Array<number>} scaleFactors Supported resolution scaling factors.\n * @property {number} width Tile width in pixels.\n * @property {number} [height] Tile height in pixels. Same as tile width if height is\n * not given.\n */\n\n/**\n * @typedef {Object} IiifProfile\n * @property {Array<string>} [formats] Supported image formats for the image service.\n * @property {Array<string>} [qualities] Supported IIIF image qualities.\n * @property {Array<string>} [supports] Supported features.\n * @property {number} [maxArea] Maximum area (pixels) available for this image service.\n * @property {number} [maxHeight] Maximum height.\n * @property {number} [maxWidth] Maximum width.\n */\n\n/**\n * @typedef {Object<string,string|number|Array<number|string|IiifProfile|Object<string, number>|TileInfo>>}\n *    ImageInformationResponse\n */\n\n/**\n * Enum representing the major IIIF Image API versions\n * @enum {string}\n */\nexport const Versions = {\n  VERSION1: 'version1',\n  VERSION2: 'version2',\n  VERSION3: 'version3',\n};\n\n/**\n * Supported image formats, qualities and supported region / size calculation features\n * for different image API versions and compliance levels\n * @const\n * @type {Object<string, Object<string, SupportedFeatures>>}\n */\nconst IIIF_PROFILE_VALUES = {};\nIIIF_PROFILE_VALUES[Versions.VERSION1] = {\n  'level0': {\n    supports: [],\n    formats: [],\n    qualities: ['native'],\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['native'],\n  },\n  'level2': {\n    supports: [\n      'regionByPx',\n      'regionByPct',\n      'sizeByW',\n      'sizeByH',\n      'sizeByPct',\n      'sizeByConfinedWh',\n      'sizeByWh',\n    ],\n    formats: ['jpg', 'png'],\n    qualities: ['native', 'color', 'grey', 'bitonal'],\n  },\n};\nIIIF_PROFILE_VALUES[Versions.VERSION2] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default'],\n  },\n  'level1': {\n    supports: ['regionByPx', 'sizeByW', 'sizeByH', 'sizeByPct'],\n    formats: ['jpg'],\n    qualities: ['default'],\n  },\n  'level2': {\n    supports: [\n      'regionByPx',\n      'regionByPct',\n      'sizeByW',\n      'sizeByH',\n      'sizeByPct',\n      'sizeByConfinedWh',\n      'sizeByDistortedWh',\n      'sizeByWh',\n    ],\n    formats: ['jpg', 'png'],\n    qualities: ['default', 'bitonal'],\n  },\n};\nIIIF_PROFILE_VALUES[Versions.VERSION3] = {\n  'level0': {\n    supports: [],\n    formats: ['jpg'],\n    qualities: ['default'],\n  },\n  'level1': {\n    supports: ['regionByPx', 'regionSquare', 'sizeByW', 'sizeByH', 'sizeByWh'],\n    formats: ['jpg'],\n    qualities: ['default'],\n  },\n  'level2': {\n    supports: [\n      'regionByPx',\n      'regionSquare',\n      'regionByPct',\n      'sizeByW',\n      'sizeByH',\n      'sizeByPct',\n      'sizeByConfinedWh',\n      'sizeByWh',\n    ],\n    formats: ['jpg', 'png'],\n    qualities: ['default'],\n  },\n};\nIIIF_PROFILE_VALUES['none'] = {\n  'none': {\n    supports: [],\n    formats: [],\n    qualities: [],\n  },\n};\n\nconst COMPLIANCE_VERSION1 =\n  /^https?:\\/\\/library\\.stanford\\.edu\\/iiif\\/image-api\\/(?:1\\.1\\/)?compliance\\.html#level[0-2]$/;\nconst COMPLIANCE_VERSION2 =\n  /^https?:\\/\\/iiif\\.io\\/api\\/image\\/2\\/level[0-2](?:\\.json)?$/;\nconst COMPLIANCE_VERSION3 =\n  /(^https?:\\/\\/iiif\\.io\\/api\\/image\\/3\\/level[0-2](?:\\.json)?$)|(^level[0-2]$)/;\n\nfunction generateVersion1Options(iiifInfo) {\n  let levelProfile = iiifInfo.getComplianceLevelSupportedFeatures();\n  // Version 1.0 and 1.1 do not require a profile.\n  if (levelProfile === undefined) {\n    levelProfile = IIIF_PROFILE_VALUES[Versions.VERSION1]['level0'];\n  }\n  return {\n    url:\n      iiifInfo.imageInfo['@id'] === undefined\n        ? undefined\n        : iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    supports: levelProfile.supports,\n    formats: [\n      ...levelProfile.formats,\n      iiifInfo.imageInfo.formats === undefined\n        ? []\n        : iiifInfo.imageInfo.formats,\n    ],\n    qualities: [\n      ...levelProfile.qualities,\n      iiifInfo.imageInfo.qualities === undefined\n        ? []\n        : iiifInfo.imageInfo.qualities,\n    ],\n    resolutions: iiifInfo.imageInfo.scale_factors,\n    tileSize:\n      iiifInfo.imageInfo.tile_width !== undefined\n        ? iiifInfo.imageInfo.tile_height !== undefined\n          ? [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_height]\n          : [iiifInfo.imageInfo.tile_width, iiifInfo.imageInfo.tile_width]\n        : iiifInfo.imageInfo.tile_height != undefined\n        ? [iiifInfo.imageInfo.tile_height, iiifInfo.imageInfo.tile_height]\n        : undefined,\n  };\n}\n\nfunction generateVersion2Options(iiifInfo) {\n  const levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    additionalProfile =\n      Array.isArray(iiifInfo.imageInfo.profile) &&\n      iiifInfo.imageInfo.profile.length > 1,\n    profileSupports =\n      additionalProfile && iiifInfo.imageInfo.profile[1].supports\n        ? iiifInfo.imageInfo.profile[1].supports\n        : [],\n    profileFormats =\n      additionalProfile && iiifInfo.imageInfo.profile[1].formats\n        ? iiifInfo.imageInfo.profile[1].formats\n        : [],\n    profileQualities =\n      additionalProfile && iiifInfo.imageInfo.profile[1].qualities\n        ? iiifInfo.imageInfo.profile[1].qualities\n        : [];\n  return {\n    url: iiifInfo.imageInfo['@id'].replace(/\\/?(?:info\\.json)?$/g, ''),\n    sizes:\n      iiifInfo.imageInfo.sizes === undefined\n        ? undefined\n        : iiifInfo.imageInfo.sizes.map(function (size) {\n            return [size.width, size.height];\n          }),\n    tileSize:\n      iiifInfo.imageInfo.tiles === undefined\n        ? undefined\n        : [\n            iiifInfo.imageInfo.tiles.map(function (tile) {\n              return tile.width;\n            })[0],\n            iiifInfo.imageInfo.tiles.map(function (tile) {\n              return tile.height === undefined ? tile.width : tile.height;\n            })[0],\n          ],\n    resolutions:\n      iiifInfo.imageInfo.tiles === undefined\n        ? undefined\n        : iiifInfo.imageInfo.tiles.map(function (tile) {\n            return tile.scaleFactors;\n          })[0],\n    supports: [...levelProfile.supports, ...profileSupports],\n    formats: [...levelProfile.formats, ...profileFormats],\n    qualities: [...levelProfile.qualities, ...profileQualities],\n  };\n}\n\nfunction generateVersion3Options(iiifInfo) {\n  const levelProfile = iiifInfo.getComplianceLevelSupportedFeatures(),\n    formats =\n      iiifInfo.imageInfo.extraFormats === undefined\n        ? levelProfile.formats\n        : [...levelProfile.formats, ...iiifInfo.imageInfo.extraFormats],\n    preferredFormat =\n      iiifInfo.imageInfo.preferredFormats !== undefined &&\n      Array.isArray(iiifInfo.imageInfo.preferredFormats) &&\n      iiifInfo.imageInfo.preferredFormats.length > 0\n        ? iiifInfo.imageInfo.preferredFormats\n            .filter(function (format) {\n              return ['jpg', 'png', 'gif'].includes(format);\n            })\n            .reduce(function (acc, format) {\n              return acc === undefined && formats.includes(format)\n                ? format\n                : acc;\n            }, undefined)\n        : undefined;\n  return {\n    url: iiifInfo.imageInfo['id'],\n    sizes:\n      iiifInfo.imageInfo.sizes === undefined\n        ? undefined\n        : iiifInfo.imageInfo.sizes.map(function (size) {\n            return [size.width, size.height];\n          }),\n    tileSize:\n      iiifInfo.imageInfo.tiles === undefined\n        ? undefined\n        : [\n            iiifInfo.imageInfo.tiles.map(function (tile) {\n              return tile.width;\n            })[0],\n            iiifInfo.imageInfo.tiles.map(function (tile) {\n              return tile.height;\n            })[0],\n          ],\n    resolutions:\n      iiifInfo.imageInfo.tiles === undefined\n        ? undefined\n        : iiifInfo.imageInfo.tiles.map(function (tile) {\n            return tile.scaleFactors;\n          })[0],\n    supports:\n      iiifInfo.imageInfo.extraFeatures === undefined\n        ? levelProfile.supports\n        : [...levelProfile.supports, ...iiifInfo.imageInfo.extraFeatures],\n    formats: formats,\n    qualities:\n      iiifInfo.imageInfo.extraQualities === undefined\n        ? levelProfile.qualities\n        : [...levelProfile.qualities, ...iiifInfo.imageInfo.extraQualities],\n    preferredFormat: preferredFormat,\n  };\n}\n\nconst versionFunctions = {};\nversionFunctions[Versions.VERSION1] = generateVersion1Options;\nversionFunctions[Versions.VERSION2] = generateVersion2Options;\nversionFunctions[Versions.VERSION3] = generateVersion3Options;\n\n/**\n * @classdesc\n * Format for transforming IIIF Image API image information responses into\n * IIIF tile source ready options\n *\n * @api\n */\nclass IIIFInfo {\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   */\n  constructor(imageInfo) {\n    this.setImageInfo(imageInfo);\n  }\n\n  /**\n   * @param {string|ImageInformationResponse} imageInfo\n   * Deserialized image information JSON response object or JSON response as string\n   * @api\n   */\n  setImageInfo(imageInfo) {\n    if (typeof imageInfo == 'string') {\n      this.imageInfo = JSON.parse(imageInfo);\n    } else {\n      this.imageInfo = imageInfo;\n    }\n  }\n\n  /**\n   * @return {Versions|undefined} Major IIIF version.\n   * @api\n   */\n  getImageApiVersion() {\n    if (this.imageInfo === undefined) {\n      return undefined;\n    }\n    let context = this.imageInfo['@context'] || 'ol-no-context';\n    if (typeof context == 'string') {\n      context = [context];\n    }\n    for (let i = 0; i < context.length; i++) {\n      switch (context[i]) {\n        case 'http://library.stanford.edu/iiif/image-api/1.1/context.json':\n        case 'http://iiif.io/api/image/1/context.json':\n          return Versions.VERSION1;\n        case 'http://iiif.io/api/image/2/context.json':\n          return Versions.VERSION2;\n        case 'http://iiif.io/api/image/3/context.json':\n          return Versions.VERSION3;\n        case 'ol-no-context':\n          // Image API 1.0 has no '@context'\n          if (\n            this.getComplianceLevelEntryFromProfile(Versions.VERSION1) &&\n            this.imageInfo.identifier\n          ) {\n            return Versions.VERSION1;\n          }\n          break;\n        default:\n      }\n    }\n    assert(\n      false,\n      'Cannot determine IIIF Image API version from provided image information JSON'\n    );\n  }\n\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string|undefined} Compliance level as it appears in the IIIF image information\n   * response.\n   */\n  getComplianceLevelEntryFromProfile(version) {\n    if (this.imageInfo === undefined || this.imageInfo.profile === undefined) {\n      return undefined;\n    }\n    if (version === undefined) {\n      version = this.getImageApiVersion();\n    }\n    switch (version) {\n      case Versions.VERSION1:\n        if (COMPLIANCE_VERSION1.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION3:\n        if (COMPLIANCE_VERSION3.test(this.imageInfo.profile)) {\n          return this.imageInfo.profile;\n        }\n        break;\n      case Versions.VERSION2:\n        if (\n          typeof this.imageInfo.profile === 'string' &&\n          COMPLIANCE_VERSION2.test(this.imageInfo.profile)\n        ) {\n          return this.imageInfo.profile;\n        }\n        if (\n          Array.isArray(this.imageInfo.profile) &&\n          this.imageInfo.profile.length > 0 &&\n          typeof this.imageInfo.profile[0] === 'string' &&\n          COMPLIANCE_VERSION2.test(this.imageInfo.profile[0])\n        ) {\n          return this.imageInfo.profile[0];\n        }\n        break;\n      default:\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Versions} version Optional IIIF image API version\n   * @return {string} Compliance level, on of 'level0', 'level1' or 'level2' or undefined\n   */\n  getComplianceLevelFromProfile(version) {\n    const complianceLevel = this.getComplianceLevelEntryFromProfile(version);\n    if (complianceLevel === undefined) {\n      return undefined;\n    }\n    const level = complianceLevel.match(/level[0-2](?:\\.json)?$/g);\n    return Array.isArray(level) ? level[0].replace('.json', '') : undefined;\n  }\n\n  /**\n   * @return {SupportedFeatures|undefined} Image formats, qualities and region / size calculation\n   * methods that are supported by the IIIF service.\n   */\n  getComplianceLevelSupportedFeatures() {\n    if (this.imageInfo === undefined) {\n      return undefined;\n    }\n    const version = this.getImageApiVersion();\n    const level = this.getComplianceLevelFromProfile(version);\n    if (level === undefined) {\n      return IIIF_PROFILE_VALUES['none']['none'];\n    }\n    return IIIF_PROFILE_VALUES[version][level];\n  }\n\n  /**\n   * @param {PreferredOptions} [preferredOptions] Optional options for preferred format and quality.\n   * @return {import(\"../source/IIIF.js\").Options|undefined} IIIF tile source ready constructor options.\n   * @api\n   */\n  getTileSourceOptions(preferredOptions) {\n    const options = preferredOptions || {},\n      version = this.getImageApiVersion();\n    if (version === undefined) {\n      return undefined;\n    }\n    const imageOptions =\n      version === undefined ? undefined : versionFunctions[version](this);\n    if (imageOptions === undefined) {\n      return undefined;\n    }\n    return {\n      url: imageOptions.url,\n      version: version,\n      size: [this.imageInfo.width, this.imageInfo.height],\n      sizes: imageOptions.sizes,\n      format:\n        options.format !== undefined &&\n        imageOptions.formats.includes(options.format)\n          ? options.format\n          : imageOptions.preferredFormat !== undefined\n          ? imageOptions.preferredFormat\n          : 'jpg',\n      supports: imageOptions.supports,\n      quality:\n        options.quality && imageOptions.qualities.includes(options.quality)\n          ? options.quality\n          : imageOptions.qualities.includes('native')\n          ? 'native'\n          : 'default',\n      resolutions: Array.isArray(imageOptions.resolutions)\n        ? imageOptions.resolutions.sort(function (a, b) {\n            return b - a;\n          })\n        : undefined,\n      tileSize: imageOptions.tileSize,\n    };\n  }\n}\n\nexport default IIIFInfo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}